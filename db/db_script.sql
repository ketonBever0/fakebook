-- Teljes adatbázist generáló szkript a truevoly/oracle-12c Docker képfájlhoz (egyéb Oracle 12c-t futtató képfájllal/szerverrel is működhet)
-- A futtatáshoz rendelkezzünk felhasználó készítését és sémájuk szerkesztését biztosító vagy DBA jogosultsággal ("sys" fiók megteszi)
-- A "CREATE INDEX" parancsokat kivettem, mert a táblával együtt egyébként is létrejönnek, emiatt hibát dobtak, miszerint léteznek

-- A táblák létrehozás után feltöltődnek adatokkal
-- Az ID- és bizonyos dátum mezők szándékosan vannak kihagyva demonstrálva a szekvenciák és a SYSDATE megfelelő működését


-- DROP USER FAKEBOOK CASCADE;
-- ^ Ha újra akarod generálni a sémát vedd ki a kommentet a fenti sorból,
-- DE előtte állítsd le a backendet


CREATE USER fakebook
IDENTIFIED BY "fkbU#123"
DEFAULT TABLESPACE users
QUOTA 200M ON users;

GRANT CREATE SESSION, CREATE TABLE, CREATE VIEW, CREATE SEQUENCE, CREATE SYNONYM TO fakebook;

CREATE SEQUENCE FAKEBOOK.COMMENTS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.FRIENDS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.GROUPS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.GROUP_MESSAGES_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.INTERESTS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.MESSAGES_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.POSTS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.USERS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.USER_GROUPS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.USER_INTERESTS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

CREATE SEQUENCE FAKEBOOK.FORBIDDEN_EXPRESSIONS_ID_SEQ INCREMENT BY 1 MINVALUE 100 MAXVALUE 9999999999999999999999999999 NOCYCLE NOCACHE ORDER ;

-- Táblák létrehozása
CREATE TABLE "FAKEBOOK"."USERS" 
   (	"ID" NUMBER(38,0) DEFAULT ON NULL "FAKEBOOK"."USERS_ID_SEQ".NEXTVAL NOT NULL ENABLE, 
	"EMAIL" VARCHAR2(100) NOT NULL ENABLE, 
	"FULLNAME" VARCHAR2(100) NOT NULL ENABLE, 
	"PASSWORD" VARCHAR2(100) NOT NULL ENABLE, 
	"BIRTH_DATE" DATE NOT NULL ENABLE, 
	"COMPANY" VARCHAR2(100) NOT NULL ENABLE, 
	"PICTURE_URL" VARCHAR2(100), 
	"REGISTERED_AT" DATE DEFAULT SYSDATE NOT NULL ENABLE, 
	"LAST_LOGIN" DATE DEFAULT SYSDATE NOT NULL ENABLE, 
	 CONSTRAINT "USERS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "USERS_EMAIL_UNIQUE" UNIQUE ("EMAIL")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE FAKEBOOK.USERS ADD "ROLE" VARCHAR2(100) DEFAULT 'NORMAL' NOT NULL;


CREATE TABLE "FAKEBOOK"."POSTS" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL FAKEBOOK.POSTS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"TEXT" VARCHAR2(100) NOT NULL ENABLE, 
	"IMAGE_URL" VARCHAR2(100), 
	"AUTHOR_ID" NUMBER(*,0), 
	 CONSTRAINT "POSTS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."POSTS" ADD CONSTRAINT "POSTS_USERS_FK" FOREIGN KEY ("AUTHOR_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE CASCADE ENABLE;


CREATE TABLE "FAKEBOOK"."COMMENTS" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL FAKEBOOK.COMMENTS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"TEXT" VARCHAR2(100) NOT NULL ENABLE, 
	"AUTHOR_ID" NUMBER(*,0), 
	"POST_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "COMMENTS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."COMMENTS" ADD CONSTRAINT "COMMENTS_POSTS_FK" FOREIGN KEY ("POST_ID")
	  REFERENCES "FAKEBOOK"."POSTS" ("ID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "FAKEBOOK"."COMMENTS" ADD CONSTRAINT "COMMENTS_USERS_FK" FOREIGN KEY ("AUTHOR_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE SET NULL ENABLE;


CREATE TABLE "FAKEBOOK"."FRIENDS" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL FAKEBOOK.FRIENDS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"PENDING" NUMBER(2,1) DEFAULT 1 NOT NULL ENABLE, 
	"WHEN" DATE DEFAULT SYSDATE NOT NULL ENABLE, 
	"SENDER_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"RECEIVER_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "FRIENDS_PENDING_CHECK" CHECK (PENDING IN (0, 1)) ENABLE, 
	 CONSTRAINT "FRIENDS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."FRIENDS" ADD CONSTRAINT "FRIENDS_USERS_FK" FOREIGN KEY ("SENDER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "FAKEBOOK"."FRIENDS" ADD CONSTRAINT "FRIENDS_USERS_FK_1" FOREIGN KEY ("RECEIVER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE CASCADE ENABLE;


CREATE TABLE "FAKEBOOK"."GROUPS" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL FAKEBOOK.GROUPS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"NAME" VARCHAR2(100) NOT NULL ENABLE, 
	"PRIVATE" NUMBER(2,1) DEFAULT 0 NOT NULL ENABLE, 
	 CONSTRAINT "GROUPS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "GROUPS_UNIQUE" UNIQUE ("NAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "GROUPS_PRIVATE_CHECK" CHECK (PRIVATE IN (0, 1)) ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;


CREATE TABLE "FAKEBOOK"."GROUP_MESSAGES" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL FAKEBOOK.GROUP_MESSAGES_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"TEXT" VARCHAR2(100) NOT NULL ENABLE, 
	"WHEN" DATE DEFAULT SYSDATE NOT NULL ENABLE, 
	"GROUP_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"SENDER_ID" NUMBER(*,0), 
	 CONSTRAINT "GROUP_MESSAGES_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."GROUP_MESSAGES" ADD CONSTRAINT "GROUP_MESSAGES_GROUPS_FK" FOREIGN KEY ("GROUP_ID")
	  REFERENCES "FAKEBOOK"."GROUPS" ("ID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "FAKEBOOK"."GROUP_MESSAGES" ADD CONSTRAINT "GROUP_MESSAGES_USERS_FK" FOREIGN KEY ("SENDER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE SET NULL ENABLE;


CREATE TABLE "FAKEBOOK"."INTERESTS" 
   (	"ID" NUMBER(38,0) DEFAULT ON NULL "FAKEBOOK"."INTERESTS_ID_SEQ"."NEXTVAL" NOT NULL ENABLE, 
	"NAME" VARCHAR2(100) NOT NULL ENABLE, 
	 CONSTRAINT "INTERESTS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "INTERESTS_NAME_UNIQUE" UNIQUE ("NAME")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;


CREATE TABLE "FAKEBOOK"."MESSAGES" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL "FAKEBOOK"."MESSAGES_ID_SEQ"."NEXTVAL" NOT NULL ENABLE, 
	"TEXT" VARCHAR2(100) NOT NULL ENABLE, 
	"WHEN" DATE DEFAULT SYSDATE NOT NULL ENABLE, 
	"SENDER_ID" NUMBER(38,0), 
	"RECEIVER_ID" NUMBER(38,0), 
	 CONSTRAINT "MESSAGES_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."MESSAGES" ADD CONSTRAINT "MESSAGES_USERS_FK" FOREIGN KEY ("SENDER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE SET NULL ENABLE;
  ALTER TABLE "FAKEBOOK"."MESSAGES" ADD CONSTRAINT "MESSAGES_USERS_FK_1" FOREIGN KEY ("RECEIVER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE SET NULL ENABLE;


CREATE TABLE "FAKEBOOK"."USER_GROUPS" 
   (	"ID" VARCHAR2(100) DEFAULT ON NULL FAKEBOOK.USER_GROUPS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"ROLE" VARCHAR2(100) DEFAULT 'NORMAL' NOT NULL ENABLE, 
	"USER_ID" NUMBER(*,0), 
	"GROUP_ID" NUMBER(*,0),  
	 CONSTRAINT "USER_GROUPS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."USER_GROUPS" ADD CONSTRAINT "USER_GROUPS_GROUPS_FK" FOREIGN KEY ("GROUP_ID")
	  REFERENCES "FAKEBOOK"."GROUPS" ("ID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "FAKEBOOK"."USER_GROUPS" ADD CONSTRAINT "USER_GROUPS_USERS_FK" FOREIGN KEY ("USER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE CASCADE ENABLE;


CREATE TABLE "FAKEBOOK"."USER_INTERESTS" 
   (	"ID" NUMBER(*,0) DEFAULT ON NULL "FAKEBOOK"."USER_INTERESTS_ID_SEQ"."NEXTVAL" NOT NULL ENABLE, 
	"USER_ID" NUMBER(*,0) NOT NULL ENABLE, 
	"INTEREST_ID" NUMBER(*,0) NOT NULL ENABLE, 
	 CONSTRAINT "USER_INTERESTS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;

ALTER TABLE "FAKEBOOK"."USER_INTERESTS" ADD CONSTRAINT "USER_INTERESTS_INTERESTS_FK" FOREIGN KEY ("INTEREST_ID")
	  REFERENCES "FAKEBOOK"."INTERESTS" ("ID") ON DELETE CASCADE ENABLE;
  ALTER TABLE "FAKEBOOK"."USER_INTERESTS" ADD CONSTRAINT "USER_INTERESTS_USERS_FK" FOREIGN KEY ("USER_ID")
	  REFERENCES "FAKEBOOK"."USERS" ("ID") ON DELETE CASCADE ENABLE;

-- FAKEBOOK.FORBIDDEN_EXPRESSIONS definition

CREATE TABLE "FAKEBOOK"."FORBIDDEN_EXPRESSIONS" 
   (	"ID" NUMBER(38,0) DEFAULT FAKEBOOK.FORBIDDEN_EXPRESSIONS_ID_SEQ.NEXTVAL NOT NULL ENABLE, 
	"PATTERN" VARCHAR2(100) NOT NULL ENABLE, 
	 CONSTRAINT "FORBIDDEN_EXPRESSIONS_PK" PRIMARY KEY ("ID")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE, 
	 CONSTRAINT "FORBIDDEN_EXPRESSIONS_UNIQUE" UNIQUE ("PATTERN")
  USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS"  ENABLE
   ) SEGMENT CREATION IMMEDIATE 
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255 
 NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "USERS" ;


-- Táblák feltöltése adatokkal

-- USERS
INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, ROLE)
VALUES (0, 'system@example.com', 'Fakebook System', '**', TO_DATE('1990-05-15', 'YYYY-MM-DD'), 'FakeBook Inc.', 'ADMIN');

INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, PICTURE_URL, ROLE)
VALUES (1, 'johndoe@example.com', 'John Doe', '$argon2id$v=19$m=65536,t=3,p=4$voBg+LKl57PyQW3BrttpXQ$H2Kmv776/syEl6BzBmYv+BjI+kL4Lt/wapkxDxVzf6M', TO_DATE('2025-05-19', 'YYYY-MM-DD'), 'FakeBook Inc.', 'http://example.com/johndoe.jpg', 'ADMIN');

INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, PICTURE_URL, ROLE )
VALUES (2, 'janedoe@example.com', 'Jane Doe', '$argon2id$v=19$m=65536,t=3,p=4$9h3S8Po5nYoRk3DmOD6kgA$wy/eKdSc5prUyfaWQrZSawBsVx/LO1O7wPT/zwQKItE', TO_DATE('1992-08-21', 'YYYY-MM-DD'), 'FakeBook Ltd.', 'http://example.com/janedoe.jpg', 'ADMIN');

INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, PICTURE_URL, ROLE)
VALUES (3, 'alexsmith@example.com', 'Alex Smith', '$argon2id$v=19$m=65536,t=3,p=4$qWSc3OVKNQ6mAy66wqUGZg$A0v/I//w5IE36jQVPrpZp/cTVsBLuOe9Prj/9RYoyok', TO_DATE('1985-11-10', 'YYYY-MM-DD'), 'Tech Inc.', NULL, 'MODERATOR');

INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, PICTURE_URL)
VALUES (4, 'emilyjones@example.com', 'Emily Jones', '$argon2id$v=19$m=65536,t=3,p=4$8sii2ixQu78DwljTA7dSRw$ypZi9e7wBEng4TEUggMLYj9x1U3JspdtDdNckeCsbmI', TO_DATE('1993-03-02', 'YYYY-MM-DD'), 'Creative Solutions', NULL);

INSERT INTO FAKEBOOK.USERS (ID, EMAIL, FULLNAME, PASSWORD, BIRTH_DATE, COMPANY, PICTURE_URL)
VALUES (5, 'michaelbrown@example.com', 'Michael Brown', '$argon2id$v=19$m=65536,t=3,p=4$KfmM1SBAqJYVEuecRb+vVQ$05i73xpHoR3s0eWn4eJHew4pI3ZRNeefo0yFwWnaXZg', TO_DATE('1989-07-19', 'YYYY-MM-DD'), 'Innovative Co.', NULL);

-- POSTS
INSERT INTO FAKEBOOK.POSTS (ID, TEXT, IMAGE_URL, AUTHOR_ID)
VALUES (1, 'This is my first post!', 'http://example.com/image1.jpg', 1);

INSERT INTO FAKEBOOK.POSTS (ID, TEXT, IMAGE_URL, AUTHOR_ID)
VALUES (2, 'Check out this cool picture!', NULL, 2);

INSERT INTO FAKEBOOK.POSTS (ID, TEXT, IMAGE_URL, AUTHOR_ID)
VALUES (3, 'Had a great day at the beach!', 'http://example.com/image3.jpg', 3);

INSERT INTO FAKEBOOK.POSTS (ID, TEXT, IMAGE_URL, AUTHOR_ID)
VALUES (4, 'Just finished a great book!', 'http://example.com/image4.jpg', 4);

INSERT INTO FAKEBOOK.POSTS (ID, TEXT, IMAGE_URL, AUTHOR_ID)
VALUES (5, 'Started learning a new programming language!', NULL, 5);


INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (6, 'Another busy day at work!', 'http://example.com/image6.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (7, 'Just completed a marathon! #achievement', 'http://example.com/image7.jpg', 4);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (8, 'Enjoying some family time today.', 'http://example.com/image8.jpg', 5);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (9, 'Just got back from a vacation!', 'http://example.com/image9.jpg', 1);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (10, 'Learning a new programming language today!', 'http://example.com/image10.jpg', 1);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (11, 'Had a wonderful dinner with family.', 'http://example.com/image11.jpg', 1);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (12, 'Hiking in the mountains today!', 'http://example.com/image12.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (13, 'Caught up with an old friend!', 'http://example.com/image13.jpg', 3);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (14, 'Just launched a new project at work!', 'http://example.com/image14.jpg', 4);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (15, 'Celebrating a milestone today!', 'http://example.com/image15.jpg', 5);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (16, 'Grateful for everything I have.', 'http://example.com/image16.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (17, 'Working on a new blog post!', 'http://example.com/image17.jpg', 4);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (18, 'Loving the new book I started!', 'http://example.com/image18.jpg', 1);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (19, 'Check out this cool new app I discovered!', 'http://example.com/image19.jpg', 3);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (20, 'Great to be back after a short break.', 'http://example.com/image20.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (21, 'Can’t wait for the concert this weekend!', 'http://example.com/image21.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (22, 'Had an amazing day at the beach.', 'http://example.com/image22.jpg', 2);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (23, 'Just started a new fitness routine!', 'http://example.com/image23.jpg', 1);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (24, 'Looking forward to the holiday season!', 'http://example.com/image24.jpg', 5);

INSERT INTO "FAKEBOOK"."POSTS" ("ID", "TEXT", "IMAGE_URL", "AUTHOR_ID") 
VALUES (25, 'Enjoying a quiet day at home.', 'http://example.com/image25.jpg', 4);

-- COMMENTS
INSERT INTO FAKEBOOK.COMMENTS (TEXT, AUTHOR_ID, POST_ID)
VALUES ('Great post!', 2, 1);

INSERT INTO FAKEBOOK.COMMENTS (TEXT, AUTHOR_ID, POST_ID)
VALUES ('Nice picture!', 1, 2);

INSERT INTO FAKEBOOK.COMMENTS (TEXT, AUTHOR_ID, POST_ID)
VALUES ('Looks like a fun day!', 3, 3);

INSERT INTO FAKEBOOK.COMMENTS (TEXT, AUTHOR_ID, POST_ID)
VALUES ('I also loved that book!', 4, 4);

INSERT INTO FAKEBOOK.COMMENTS (TEXT, AUTHOR_ID, POST_ID)
VALUES ('Good luck with your coding journey!', 5, 5);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (1, 'Great post, keep it up!', 2, 1);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (2, 'Looks like you had a great time!', 3, 2);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (3, 'Congrats on completing the marathon!', 4, 7);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (4, 'Enjoy your family time!', 5, 8);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (5, 'I love hiking too! Where did you go?', 2, 12);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (6, 'The dinner must have been great!', 1, 11);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (7, 'What project are you working on?', 4, 14);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (8, 'Congratulations on your milestone!', 5, 15);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (9, 'That book sounds interesting!', 1, 18);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (10, 'I want to try that app too!', 1, 19);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (11, 'It’s good to take breaks sometimes.', 2, 20);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (12, 'Have fun at the concert!', 5, 21);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (13, 'The beach is always a good choice!', 4, 22);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (14, 'I hope your fitness routine goes well!', 5, 23);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (15, 'Enjoy the holiday season!', 1, 24);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (16, 'Stay cozy on your quiet day!', 5, 25);

INSERT INTO "FAKEBOOK"."COMMENTS" ("ID", "TEXT", "AUTHOR_ID", "POST_ID") 
VALUES (17, 'I love your positive vibes!', 1, 4);


-- FRIENDS
INSERT INTO FAKEBOOK.FRIENDS (PENDING, SENDER_ID, RECEIVER_ID)
VALUES (1, 1, 2);

INSERT INTO FAKEBOOK.FRIENDS (PENDING, SENDER_ID, RECEIVER_ID)
VALUES (0, 2, 1);

INSERT INTO FAKEBOOK.FRIENDS (PENDING, SENDER_ID, RECEIVER_ID)
VALUES (1, 3, 4);

INSERT INTO FAKEBOOK.FRIENDS (PENDING, SENDER_ID, RECEIVER_ID)
VALUES (0, 4, 3);

INSERT INTO FAKEBOOK.FRIENDS (PENDING, SENDER_ID, RECEIVER_ID)
VALUES (1, 5, 1);

-- GROUPS
INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (28,'TestGG2',1);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (1,'Tech Enthusiasts',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (3,'Music Fans',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (4,'Travel Addicts',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (5,'Cooking Lovers',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (6,'Smink csopi',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (7,'Használt autó',0);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (8,'Linux dev',1);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (9,'KKK',1);

INSERT INTO FAKEBOOK.GROUPS (ID,NAME,PRIVATE) VALUES (10,'Zümi Gang',1);


-- GROUP_MESSAGES
INSERT INTO FAKEBOOK.GROUP_MESSAGES (TEXT, GROUP_ID, SENDER_ID)
VALUES ('Hello group!', 1, 1);

INSERT INTO FAKEBOOK.GROUP_MESSAGES (TEXT, GROUP_ID, SENDER_ID)
VALUES ('Anyone here a fan of rock music?', 3, 3);

INSERT INTO FAKEBOOK.GROUP_MESSAGES (TEXT, GROUP_ID, SENDER_ID)
VALUES ('I''m planning a trip to Italy!', 4, 4);

INSERT INTO FAKEBOOK.GROUP_MESSAGES (TEXT, GROUP_ID, SENDER_ID)
VALUES ('Does anyone have a good recipe for lasagna?', 5, 5);

-- INTERESTS
INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (1,'Technology');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (2,'Reading');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (3,'Music');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (4,'Travel');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (5,'Cooking');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (6,'Gaming');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (7,'Driving');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (8,'Cycling');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (9,'Gym');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (10,'Coding');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (11,'Business');

INSERT INTO FAKEBOOK.INTERESTS (ID, NAME)
VALUES (12,'Literature');


-- USER_INTERESTS
INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (1, 2, 6);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (2, 5, 9);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (3, 2, 9);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (4, 5, 12);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (5, 3, 10);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (6, 1, 1);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (7, 1, 2);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (8, 4, 10);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (9, 4, 3);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (10, 2, 4);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (11, 3, 4);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (12, 4, 11);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (13, 4, 1);

INSERT INTO FAKEBOOK.USER_INTERESTS VALUES (14, 1, 5);


-- MESSAGES
INSERT INTO FAKEBOOK.MESSAGES (ID, TEXT, SENDER_ID, RECEIVER_ID)
VALUES (1, 'Hey, how are you?', 1, 2);

INSERT INTO FAKEBOOK.MESSAGES (ID, TEXT, SENDER_ID, RECEIVER_ID)
VALUES (2, 'I''m doing well, thanks!', 2, 1);

INSERT INTO FAKEBOOK.MESSAGES (ID, TEXT, SENDER_ID, RECEIVER_ID)
VALUES (3, 'What time is our meeting tomorrow?', 3, 4);

INSERT INTO FAKEBOOK.MESSAGES (ID, TEXT, SENDER_ID, RECEIVER_ID)
VALUES (4, 'I finished the project! Check it out!', 4, 5);

INSERT INTO FAKEBOOK.MESSAGES (ID, TEXT, SENDER_ID, RECEIVER_ID)
VALUES (5, 'Can''t wait for our vacation together!', 5, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (6, 'Yes, I went there last week! It was amazing.', SYSDATE, 4, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (7, 'We should go together sometime.', SYSDATE, 4, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (8, 'Sounds like a plan!', SYSDATE, 2, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (9, 'I found a great spot for a weekend hike!', SYSDATE, 1, 5);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (10, 'Awesome! Let me know when you’re free.', SYSDATE, 5, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (11, 'Do you want to join me for a movie tonight?', SYSDATE, 3, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (12, 'Sure, that sounds fun!', SYSDATE, 4, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (13, 'I’m planning a weekend getaway, want to join?', SYSDATE, 2, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (14, 'That sounds exciting! Let me think about it.', SYSDATE, 1, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (15, 'Looking forward to it!', SYSDATE, 1, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (16, 'Me too! Let’s make it happen soon.', SYSDATE, 4, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (17, 'Are you up for a game night?', SYSDATE, 3, 5);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (18, 'Absolutely, I love game nights!', SYSDATE, 5, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (19, 'Let’s meet up for coffee later.', SYSDATE, 2, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (20, 'I’ll be there in an hour!', SYSDATE, 3, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (21, 'Hey, did you finish the project we discussed?', SYSDATE, 4, 5);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (22, 'Yes, I just wrapped it up!', SYSDATE, 5, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (23, 'Great job! Let’s review it tomorrow.', SYSDATE, 4, 5);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (24, 'Sure, I’ll be ready.', SYSDATE, 5, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (25, 'How was your weekend getaway?', SYSDATE, 2, 4);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (26, 'It was amazing! We should plan another trip together.', SYSDATE, 4, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (27, 'What time works for you to meet this week?', SYSDATE, 3, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (28, 'I’m free on Friday, let’s do it then.', SYSDATE, 1, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (29, 'I need help with a task, are you available?', SYSDATE, 5, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (30, 'Of course, let me know what you need.', SYSDATE, 3, 5);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (31, 'Hey, how are you doing?', SYSDATE, 1, 2);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (32, 'I am doing great, thanks for asking!', SYSDATE, 2, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (33, 'Let’s catch up soon!', SYSDATE, 1, 3);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (34, 'Sure, I would love to!', SYSDATE, 3, 1);

INSERT INTO "FAKEBOOK"."MESSAGES" ("ID", "TEXT", "WHEN", "SENDER_ID", "RECEIVER_ID") 
VALUES (35, 'Have you checked out the new restaurant?', SYSDATE, 2, 4);




-- USER_GROUPS
INSERT INTO FAKEBOOK.USER_GROUPS (ID,"ROLE",USER_ID,GROUP_ID) VALUES ('36','PENDING',1,28);

INSERT INTO FAKEBOOK.USER_GROUPS (ID,"ROLE",USER_ID,GROUP_ID) VALUES ('17','OWNER',2,28);

INSERT INTO FAKEBOOK.USER_GROUPS (ID,"ROLE",USER_ID,GROUP_ID) VALUES ('1','OWNER',1,1);

INSERT INTO FAKEBOOK.USER_GROUPS (ID,"ROLE",USER_ID,GROUP_ID) VALUES ('4','NORMAL',4,4);

INSERT INTO FAKEBOOK.USER_GROUPS (ID,"ROLE",USER_ID,GROUP_ID) VALUES ('5','OWNER',5,5);


INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('BUZI');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('FASZ');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('KURVA');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('KURWA');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('PUSSY');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('SZOPO');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('KÖCSÖG');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('BASZ');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('BAZD');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('FUCK');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('SHIT');
INSERT INTO FAKEBOOK.FORBIDDEN_EXPRESSIONS (PATTERN) VALUES ('BITCH');

-- DROP FUNCTION FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN;

-- Obszcén kifejezést nem tartalmazhat a fullname (egyelőre csak ez, később tervben lesz pl. a csoportnév)

-- Itt muszáj kétszer, különben nem látja a törzsben lévő paraméter hívást
CREATE OR REPLACE FUNCTION FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN (in_pattern IN VARCHAR2)
RETURN NUMBER IS
	match_count NUMBER;

CREATE OR REPLACE FUNCTION FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN (in_pattern IN VARCHAR2)
RETURN NUMBER IS
	match_count NUMBER;
BEGIN
	SELECT COUNT(PATTERN)
	INTO match_count
	FROM FAKEBOOK.FORBIDDEN_EXPRESSIONS
	WHERE UPPER(in_pattern) LIKE UPPER('%' || pattern || '%');
	RETURN CASE WHEN match_count > 0 THEN 1 ELSE 0 END;
END;


-- Érzékeli a trigger, ha talál, hibát dob, aminek szövegét a backend értelmezi
CREATE OR REPLACE TRIGGER FAKEBOOK.CHECK_FULLNAME_T
BEFORE INSERT OR UPDATE OF FULLNAME ON FAKEBOOK.USERS
FOR EACH ROW
BEGIN
	IF FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN(:NEW.FULLNAME) = 1 THEN
		RAISE_APPLICATION_ERROR(-20001, 'FORBIDDEN_EXPRESSION');
	END IF;
END;

CREATE OR REPLACE TRIGGER FAKEBOOK.INTEREST_ALREADY_ADDED_T
BEFORE INSERT ON FAKEBOOK.USER_INTERESTS
FOR EACH ROW
DECLARE
	match_count NUMBER;
BEGIN
	SELECT COUNT(id)
	INTO match_count
	FROM FAKEBOOK.USER_INTERESTS
	WHERE user_id = :NEW.user_id AND interest_id = :NEW.interest_id;

	IF match_count > 0 THEN
		RAISE_APPLICATION_ERROR(-20001, 'INTEREST_ALREADY_ADDED');
	END IF;
END;

CREATE OR REPLACE TRIGGER FAKEBOOK.EXISTING_FRIEND_REQUEST_T
BEFORE INSERT ON FAKEBOOK.FRIENDS
FOR EACH ROW
DECLARE
	match_count NUMBER;
BEGIN
	SELECT COUNT(id)
	INTO match_count
	FROM FAKEBOOK.FRIENDS
	WHERE sender_id = :NEW.sender_id AND receiver_id = :NEW.receiver_id
	OR sender_id = :NEW.receiver_id AND receiver_id = :NEW.sender_id;

	IF match_count > 0 THEN
		RAISE_APPLICATION_ERROR(-20001, 'FRIEND_ALREADY_ADDED');
	END IF;
END;


CREATE OR REPLACE TRIGGER FAKEBOOK.post_content_check
BEFORE INSERT OR UPDATE ON FAKEBOOK.POSTS
FOR EACH ROW
BEGIN  
  IF FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN(:NEW.TEXT) = 1 THEN
    RAISE_APPLICATION_ERROR(-20001, 'FORBIDDEN_EXPRESSION');
  END IF;
END;

CREATE OR REPLACE TRIGGER FAKEBOOK.comment_content_check
BEFORE INSERT OR UPDATE OF TEXT ON FAKEBOOK.COMMENTS
FOR EACH ROW
DECLARE
BEGIN  
  IF FAKEBOOK.IS_EXPRESSION_FORBIDDEN_FN(:NEW.TEXT) = 1 THEN
    RAISE_APPLICATION_ERROR(-20002, 'FORBIDDEN_EXPRESSION_IN_COMMENT');
  END IF;
END;

CREATE OR REPLACE TRIGGER FAKEBOOK.prevent_selffriending
BEFORE INSERT ON FAKEBOOK.FRIENDS
FOR EACH ROW
BEGIN
  IF :NEW.SENDER_ID = :NEW.RECEIVER_ID THEN
    RAISE_APPLICATION_ERROR(-20003, 'CANNOT_FRIEND_YOURSELF');
  END IF;
END;

CREATE OR REPLACE TRIGGER FAKEBOOK.prevent_group_owner_removal
BEFORE DELETE ON FAKEBOOK.USER_GROUPS
FOR EACH ROW
BEGIN
  IF :OLD.ROLE = 'OWNER' THEN
    RAISE_APPLICATION_ERROR(-20004, 'CANNOT_REMOVE_GROUP_OWNER');
  END IF;
END;

CREATE OR REPLACE FUNCTION FAKEBOOK.GROUP_MEMBER_COUNT_FN (in_group_id IN NUMBER)
RETURN NUMBER IS
	member_count NUMBER;

CREATE OR REPLACE FUNCTION FAKEBOOK.GROUP_MEMBER_COUNT_FN (in_group_id IN NUMBER)
RETURN NUMBER IS
	member_count NUMBER;
BEGIN
	SELECT COUNT(UG.USER_ID)
		INTO member_count
		FROM FAKEBOOK.USER_GROUPS UG
        WHERE UG.GROUP_ID = in_group_id;
	RETURN member_count;
END;

CREATE OR REPLACE FUNCTION FAKEBOOK.GROUP_MEMBER_COUNT_FN (in_group_id IN NUMBER)
RETURN NUMBER IS
	member_count NUMBER;
BEGIN
	SELECT COUNT(UG.USER_ID)
		INTO member_count
		FROM FAKEBOOK.USER_GROUPS UG
        WHERE UG.GROUP_ID = in_group_id;
	RETURN member_count;
END;
